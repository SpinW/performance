<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////opt/matlab2021b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Profile Summary</title></head><title>Function details for spinw.spinwave</title><link rel="stylesheet" href="file:////opt/matlab2021b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">spinw.spinwave (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/><i>Generated 09-Dec-2022 11:41:33 using performance time.</i><br/>function in file /mnt/ceph/home/rw1061637/spinw/swfiles/@spinw/spinwave.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Name</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Type</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file84.html">profile_spinwave</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Line Number</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Code</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Total Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Freed Memory</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Peak Memory</td><td class="td-linebottomrt" style="background-color:#F0F0F0">% Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line863">863</a></td><td class="td-linebottomrt"><pre>[V, D, orthWarn] = eigorth(gha...</pre></td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">130.016 s</td><td class="td-linebottomrt">3889709.72 Kb</td><td class="td-linebottomrt">1748372.06 Kb</td><td class="td-linebottomrt">395584.55 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">56.3%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=56 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line871">871</a></td><td class="td-linebottomrt"><pre>M              = diag(gComm*V(...</pre></td><td class="td-linebottomrt">59</td><td class="td-linebottomrt">20.868 s</td><td class="td-linebottomrt">29.06 Kb</td><td class="td-linebottomrt">0.00 Kb</td><td class="td-linebottomrt">25.48 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">9.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=9 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line922">922</a></td><td class="td-linebottomrt"><pre>sw_timeit(jj/nSlice*100,0,para...</pre></td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">15.383 s</td><td class="td-linebottomrt">2074.58 Kb</td><td class="td-linebottomrt">1452.86 Kb</td><td class="td-linebottomrt">225.75 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">6.7%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line920">920</a></td><td class="td-linebottomrt"><pre>Sab = cat(4,Sab,squeeze(sum(ze...</pre></td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">10.672 s</td><td class="td-linebottomrt">32155.38 Kb</td><td class="td-linebottomrt">15762.38 Kb</td><td class="td-linebottomrt">5741.27 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">4.6%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=5 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line872">872</a></td><td class="td-linebottomrt"><pre>V(:,:,ii)      = V(:,:,ii)*dia...</pre></td><td class="td-linebottomrt">59</td><td class="td-linebottomrt">9.391 s</td><td class="td-linebottomrt">0.00 Kb</td><td class="td-linebottomrt">1943613.09 Kb</td><td class="td-linebottomrt">0.00 Kb</td><td class="td-linebottomrt" class="td-linebottomrt">4.1%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=4 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">44.575 s</td><td class="td-linebottomrt">18014398504991944.00 Kb</td><td class="td-linebottomrt">18014398505186172.00 Kb</td><td class="td-linebottomrt">395584.55 Kb</td><td class="td-linebottomrt">19.3%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=19 height=10></td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Totals</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">230.906 s</td><td class="td-linebottomrt" style="background-color:#F0F0F0">18014398508915912.00 Kb</td><td class="td-linebottomrt" style="background-color:#F0F0F0">18014398508895372.00 Kb</td><td class="td-linebottomrt" style="background-color:#F0F0F0">18014398509284328.00 Kb</td><td class="td-linebottomrt" style="background-color:#F0F0F0">100%</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Allocated Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Freed Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Peak Memory</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file71.html">eigorth</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">129.944 s</td><td class="td-linebottomrt">3889696.22 Kb</td><td class="td-linebottomrt">2.98 Kb</td><td class="td-linebottomrt">395584.55 Kb</td><td class="td-linebottomrt">56.3%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=56 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file34.html">sw_timeit</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">12</td><td class="td-linebottomrt">18.427 s</td><td class="td-linebottomrt">2973.78 Kb</td><td class="td-linebottomrt">1772.06 Kb</td><td class="td-linebottomrt">225.75 Kb</td><td class="td-linebottomrt">8.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file70.html">sw_mtimesx</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">6.415 s</td><td class="td-linebottomrt">1086720.44 Kb</td><td class="td-linebottomrt">18014398504738398.00 Kb</td><td class="td-linebottomrt">592968.12 Kb</td><td class="td-linebottomrt">2.8%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file74.html">spinw.copy</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">4.832 s</td><td class="td-linebottomrt">604.23 Kb</td><td class="td-linebottomrt">93.78 Kb</td><td class="td-linebottomrt">33.88 Kb</td><td class="td-linebottomrt">2.1%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file1.html">swpref.swpref&gt;swpref.swpref</a></td><td class="td-linebottomrt">class method</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.980 s</td><td class="td-linebottomrt">470.05 Kb</td><td class="td-linebottomrt">105.52 Kb</td><td class="td-linebottomrt">8.72 Kb</td><td class="td-linebottomrt">0.9%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file41.html">spinw.intmatrix</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.232 s</td><td class="td-linebottomrt">4330.03 Kb</td><td class="td-linebottomrt">1847.61 Kb</td><td class="td-linebottomrt">1537.47 Kb</td><td class="td-linebottomrt">0.5%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file47.html">datestr</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.828 s</td><td class="td-linebottomrt">173.58 Kb</td><td class="td-linebottomrt">1.91 Kb</td><td class="td-linebottomrt">30.42 Kb</td><td class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file44.html">sw_readparam</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.497 s</td><td class="td-linebottomrt">91.70 Kb</td><td class="td-linebottomrt">33.08 Kb</td><td class="td-linebottomrt">32.66 Kb</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file73.html">squeeze</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">20</td><td class="td-linebottomrt">0.454 s</td><td class="td-linebottomrt">6.36 Kb</td><td class="td-linebottomrt">38.73 Kb</td><td class="td-linebottomrt">0.98 Kb</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file40.html">spinw.magstr</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.436 s</td><td class="td-linebottomrt">196.53 Kb</td><td class="td-linebottomrt">3.64 Kb</td><td class="td-linebottomrt">17.11 Kb</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file36.html">sw_qscan</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.183 s</td><td class="td-linebottomrt">47.16 Kb</td><td class="td-linebottomrt">0.08 Kb</td><td class="td-linebottomrt">10.83 Kb</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file38.html">...ef&gt;@(obj)get_data(obj,obj.Name{i})</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.122 s</td><td class="td-linebottomrt">17.30 Kb</td><td class="td-linebottomrt">6.86 Kb</td><td class="td-linebottomrt">6.17 Kb</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file45.html">now</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.095 s</td><td class="td-linebottomrt">43.98 Kb</td><td class="td-linebottomrt">3.92 Kb</td><td class="td-linebottomrt">20.89 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file55.html">mmat</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.062 s</td><td class="td-linebottomrt">131.20 Kb</td><td class="td-linebottomrt">102.12 Kb</td><td class="td-linebottomrt">52.09 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file65.html">shiftdim</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.060 s</td><td class="td-linebottomrt">4.55 Kb</td><td class="td-linebottomrt">0.09 Kb</td><td class="td-linebottomrt">1.22 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file62.html">cell2mat</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.060 s</td><td class="td-linebottomrt">9.12 Kb</td><td class="td-linebottomrt">0.00 Kb</td><td class="td-linebottomrt">5.14 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file61.html">spinw.basisvector</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.051 s</td><td class="td-linebottomrt">18.53 Kb</td><td class="td-linebottomrt">0.08 Kb</td><td class="td-linebottomrt">2.64 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file58.html">cross</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.049 s</td><td class="td-linebottomrt">27.33 Kb</td><td class="td-linebottomrt">0.06 Kb</td><td class="td-linebottomrt">17.91 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file66.html">fprintf0</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">5</td><td class="td-linebottomrt">0.045 s</td><td class="td-linebottomrt">34.88 Kb</td><td class="td-linebottomrt">8.02 Kb</td><td class="td-linebottomrt">3.50 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file39.html">spinw.symbolic</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">11.61 Kb</td><td class="td-linebottomrt">0.00 Kb</td><td class="td-linebottomrt">9.20 Kb</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">65.123 s</td><td class="td-linebottomrt">18014398503930304.00 Kb</td><td class="td-linebottomrt">4152954.00 Kb</td><td class="td-linebottomrt">18014398509284328.00 Kb</td><td class="td-linebottomrt">28.2%</td><td class="td-linebottomrt"><img src="data:image/gif;base64, R0lGODlhAQABAPcAAP8A//oA//UA//AA/+sA/+YA/+EA/9wA/9cA/9IA/80A/8gA/8MA/74A/7kA/7QA/68A/6oA/6UA/6AA/5sA/5YA/5EA/4wA/4cA/4IA/30A/3gA/3MA/24A/2kA/2QA/18A/1oA/1UA/1AA/0sA/0YA/0EA/zwA/zcA/zIA/y0A/ygA/yMA/x4A/xkA/xQA/w8A/woA/wUA/wAA/wAF/wAK/wAP/wAU/wAZ/wAe/wAj/wAo/wAt/wAy/wA3/wA8/wBB/wBG/wBL/wBQ/wBV/wBa/wBf/wBk/wBp/wBu/wBz/wB4/wB9/wCC/wCH/wCM/wCR/wCW/wCb/wCg/wCl/wCq/wCv/wC0/wC5/wC+/wDD/wDI/wDN/wDS/wDX/wDc/wDh/wDm/wDr/wDw/wD1/wD7/wD//wD/+gD/9QD/8AD/6wD/5gD/4QD/3AD/1wD/0gD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mwD/lgD/kQD/jAD/hwD/ggD/fQD/eAD/cwD/bgD/aQD/ZAD/XwD/WgD/VQD/UAD/SwD/RgD/QQD/PAD/NwD/MgD/LQD/KAD/IwD/HgD/GQD/FAD/DwD/CgD/BQD/AAX/AAr/AA//ABT/ABn/AB7/ACP/ACj/AC3/ADL/ADf/ADz/AEH/AEb/AEv/AFD/AFX/AFr/AF//AGT/AGn/AG7/AHP/AHj/AH3/AIL/AIf/AIz/AJH/AJb/AJv/AKD/AKX/AKr/AK//ALT/ALn/AL7/AMP/AMj/AM3/ANL/ANf/ANz/AOH/AOb/AOv/APD/APX/APr/AP//AP/6AP/1AP/wAP/rAP/mAP/hAP/cAP/XAP/SAP/NAP/IAP/DAP++AP+5AP+0AP+vAP+qAP+lAP+gAP+bAP+WAP+RAP+MAP+HAP+CAP99AP94AP9zAP9uAP9pAP9kAP9fAP9aAP9VAP9QAP9LAP9GAP9BAP88AP83AP8yAP8tAP8oAP8jAP8eAP8ZAP8UAP8PAP8KAP8FAP8AACwAAAAAAQABAAAIBABnBAQAOw==" width=28 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">230.906 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">18014398508915912.00 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">18014398508895372.00 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">18014398509284328.00 Kb</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Total lines in function</td><td class="td-linebottomrt">1089</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">602</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">487</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">262</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">225</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">53.80 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table id="FunctionListingTable"><tr style="height:20px;"><th><pre><span style="color:#FF0000;">time</span> </pre></th><th><pre><span style="color:#0000FF;">Calls</span> </pre></th><th><pre><span style="color:#20AF20;">mem</span> </pre></th><th class="leftAligned" COLSPAN=2><pre><span> line</span></pre></th></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   1</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">function spectra = spinwave(obj, hkl, varargin)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   2</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% calculates spin correlation function using linear spin wave theory</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   3</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   4</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### Syntax</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   5</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   6</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `spectra = spinwave(obj,Q)`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   7</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   8</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `spectra = spinwave(___,Name,Value)`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   9</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  10</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### Description</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  11</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  12</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `spinwave(obj,Q,Name,Value)` calculates spin wave dispersion and</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  13</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% spin-spin correlation function at the reciprocal space points $Q$. The</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  14</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% function can solve any single-k magnetic structure exactly and any</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  15</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% multi-k magnetic structure appoximately and quadratic spinw-spin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  16</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% interactions as well as single ion anisotropy and magnetic field.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  17</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Biquadratic exchange interactions are also implemented, however only for</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  18</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% $k_m=0$ magnetic structures.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  19</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  20</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% If the magnetic ordering wavevector is non-integer, the dispersion is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  21</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% calculated using a coordinate system rotating from unit cell to unit</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  22</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% cell. In this case the spin Hamiltonian has to fulfill this extra</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  23</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% rotational symmetry which is not checked programatically.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  24</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  25</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Some of the code of the function can run faster if mex files are used. To</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  26</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% switch on mex files, use the `swpref.setpref('usemex',true)` command. For</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  27</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% details see the [sw_mex] and [swpref.setpref] functions.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  28</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  29</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### Examples</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  30</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  31</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% To calculate and plot the spin wave dispersion of the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  32</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% triangular lattice antiferromagnet ($S=1$, $J=1$) along the $(h,h,0)$</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  33</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% direction in reciprocal space we create the built in triangular lattice</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  34</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% model using `sw_model`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  35</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  36</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  37</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% &gt;&gt;tri = sw_model('triAF',1)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  38</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% &gt;&gt;spec = tri.spinwave({[0 0 0] [1 1 0]})</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  39</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% &gt;&gt;sw_plotspec(spec)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  40</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% &gt;&gt;snapnow</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  41</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  42</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  43</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### Input Arguments</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  44</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  45</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `obj`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  46</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : [spinw] object.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  47</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  48</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `Q`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  49</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Defines the $Q$ points where the spectra is calculated, in reciprocal</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  50</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   lattice units, size is $[3\times n_{Q}]$. $Q$ can be also defined by</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  51</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   several linear scan in reciprocal space. In this case `Q` is cell type,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  52</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   where each element of the cell defines a point in $Q$ space. Linear scans</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  53</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   are assumed between consecutive points. Also the number of $Q$ points can</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  54</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   be specified as a last element, it is 100 by defaults. </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  55</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  56</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   For example to define a scan along $(h,0,0)$ from $h=0$ to $h=1$ using</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  57</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   200 $Q$ points the following input should be used:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  58</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  59</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   Q = {[0 0 0] [1 0 0]  200}</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  60</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  61</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  62</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   For symbolic calculation at a general reciprocal space point use `sym`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  63</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   type input. </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  64</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  65</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   For example to calculate the spectrum along $(h,0,0)$ use:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  66</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  67</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   Q = [sym('h') 0 0]</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  68</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  69</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   To calculate spectrum at a specific $Q$ point symbolically, e.g. at</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  70</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   $(0,1,0)$ use:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  71</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  72</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   Q = sym([0 1 0])</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  73</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  74</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  75</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### Name-Value Pair Arguments</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  76</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  77</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'formfact'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  78</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If true, the magnetic form factor is included in the spin-spin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  79</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   correlation function calculation. The form factor coefficients are</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  80</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   stored in `obj.unit_cell.ff(1,:,atomIndex)`. Default value is `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  81</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  82</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'formfactfun'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  83</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Function that calculates the magnetic form factor for given $Q$ value.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  84</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   value. Default value is `@sw_mff`, that uses a tabulated coefficients</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  85</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   for the form factor calculation. For anisotropic form factors a user</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  86</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   defined function can be written that has the following header:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  87</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  88</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   F = formfactfun(atomLabel,Q)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  89</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   ```</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  90</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   where the parameters are:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  91</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `F`           row vector containing the form factor for every input </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  92</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                   $Q$ value</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  93</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `atomLabel`   string, label of the selected magnetic atom</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  94</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `Q`           matrix with dimensions of $[3\times n_Q]$, where each</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  95</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                   column contains a $Q$ vector in $\\ang^{-1}$ units.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  96</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  97</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'cmplxBase'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  98</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If `true`, we use a local coordinate system fixed by the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  99</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   complex magnetisation vectors:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 100</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   $\begin{align}  e_1 &amp;= \Im(\hat{M})\\</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 101</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                   e_3 &amp;= Re(\hat{M})\\</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 102</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                   e_2 &amp;= e_3\times e_1</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 103</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%    \end{align}$</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 104</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   If `false`, we use a coordinate system fixed to the moments:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 105</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   $\begin{align}  e_3 \parallel S_i\\</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 106</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                   e_2 &amp;= \S_i \times [1, 0, 0]\\</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 107</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%                   e_1 &amp;= e_2 \times e_3</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 108</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   \end{align}$</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 109</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   Except if $S_i \parallel [1, 0, 0], e_2 = [0, 0, 1]$. The default is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 110</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%  `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 111</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 112</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'gtensor'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 113</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If true, the g-tensor will be included in the spin-spin correlation</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 114</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   function. Including anisotropic g-tensor or different</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 115</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   g-tensor for different ions is only possible here. Including a simple</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 116</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   isotropic g-tensor is possible afterwards using the [sw_instrument]</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 117</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   function.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 118</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 119</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'fitmode'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 120</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If `true`, function is optimized for multiple consecutive calls (e.g. </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 121</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   the output spectrum won't contain the copy of `obj`), default is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 122</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 123</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 124</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'notwin'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 125</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If `true`, the spectra of the twins won't be calculated. Default is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 126</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 127</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 128</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'sortMode'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 129</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If `true`, the spin wave modes will be sorted by continuity. Default is </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 130</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   `true`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 131</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 132</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'optmem'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 133</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Parameter to optimise memory usage. The list of Q values will be cut</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 134</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   into `optmem` number of pieces and will be calculated piece by piece to</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 135</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   decrease peak memory usage. Default value is 0, when the number</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 136</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   of slices are determined automatically from the available free memory.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 137</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 138</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'tol'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 139</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Tolerance of the incommensurability of the magnetic ordering wavevector.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 140</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   Deviations from integer values of the ordering wavevector smaller than</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 141</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   the tolerance are considered to be commensurate. Default value is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 142</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   $10^{-4}$.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 143</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 144</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'omega_tol'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 145</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Tolerance on the energy difference of degenerate modes when</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 146</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   diagonalising the quadratic form, default value is $10^{-5}$.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 147</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 148</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'hermit'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 149</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Method for matrix diagonalization with the following logical values:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 150</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 151</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `true`    using Colpa's method (for details see [J.H.P. Colpa, Physica 93A (1978) 327](http://www.sciencedirect.com/science/article/pii/0378437178901607)),</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 152</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               the dynamical matrix is converted into another Hermitian</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 153</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               matrix, that will give the real eigenvalues.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 154</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `false`   using the standard method (for details see [R.M. White, PR 139 (1965) A450](https://journals.aps.org/pr/abstract/10.1103/PhysRev.139.A450))</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 155</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               the non-Hermitian $\mathcal{g}\times \mathcal{H}$ matrix</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 156</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               will be diagonalised, which is computationally less</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 157</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               efficient. Default value is `true`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 158</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 159</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% {{note Always use Colpa's method, except when imaginary eigenvalues are</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 160</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   expected. In this case only White's method work. The solution in this</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 161</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   case is wrong, however by examining the eigenvalues it can give a hint</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 162</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   where the problem is.}}</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 163</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 164</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'saveH'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 165</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If true, the quadratic form of the Hamiltonian is also saved in the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 166</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   output. Be carefull, it can take up lots of memory. Default value is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 167</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 168</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 169</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'saveV'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 170</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If true, the matrices that transform the normal magnon modes into the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 171</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   magnon modes localized on the spins are also saved into the output. Be</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 172</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   carefull, it can take up lots of memory. Default value is `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 173</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 174</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'saveSabp'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 175</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : If true, the dynamical structure factor in the rotating frame</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 176</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   $S'(k,\omega)$ is saved. For incommensurate structures only. Default</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 177</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   value is `false`.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 178</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 179</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'title'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 180</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Gives a title string to the simulation that is saved in the output.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 181</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 182</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'fid'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 183</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Defines whether to provide text output. The default value is determined</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 184</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   by the `fid` preference stored in [swpref]. The possible values are:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 185</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `0`   No text output is generated.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 186</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `1`   Text output in the MATLAB Command Window.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 187</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `fid` File ID provided by the `fopen` command, the output is written</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 188</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%           into the opened file stream.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 189</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 190</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `'tid'`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 191</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : Determines if the elapsed and required time for the calculation is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 192</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   displayed. The default value is determined by the `tid` preference</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 193</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   stored in [swpref]. The following values are allowed (for more details</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 194</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   see [sw_timeit]):</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 195</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `0` No timing is executed.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 196</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `1` Display the timing in the Command Window.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 197</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `2` Show the timing in a separat pup-up window.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 198</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 199</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### Output Arguments</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 200</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 201</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% `spectra`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 202</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% : structure, with the following fields:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 203</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `omega`   Calculated spin wave dispersion with dimensions of</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 204</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               $[n_{mode}\times n_{Q}]$.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 205</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `Sab`     Dynamical structure factor with dimensins of</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 206</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               $[3\times 3\times n_{mode}\times n_{Q}]$. Each</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 207</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               `(:,:,i,j)` submatrix contains the 9 correlation functions</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 208</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               $S^{xx}$, $S^{xy}$, $S^{xz}$, etc. If given, magnetic form</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 209</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               factor is included. Intensity is in \\hbar units, normalized</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 210</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               to the crystallographic unit cell.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 211</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `H`       Quadratic form of the Hamiltonian. Only saved if `saveH` is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 212</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               true.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 213</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `V`       Transformation matrix from the normal magnon modes to the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 214</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               magnons localized on spins using the following:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 215</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               $x_i = \sum_j V_{ij} \times x_j'$</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 216</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               Only saved if `saveV` is true.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 217</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `Sabp`    Dynamical structure factor in the rotating frame,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 218</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               dimensions are $[3\times 3\times n_{mode}\times n_{Q}]$,</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 219</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               but the number of modes are equal to twice the number of</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 220</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               magnetic atoms.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 221</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `hkl`     Contains the input $Q$ values, dimensions are $[3\times n_{Q}]$.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 222</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `hklA`    Same $Q$ values, but in $\\ang^{-1}$ unit, in the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 223</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               lab coordinate system, dimensins are $[3\times n_{Q}]$.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 224</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `formfact`Logical value, whether the form factor has been included in</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 225</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               the spin-spin correlation function.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 226</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `incomm`  Logical value, tells whether the calculated spectra is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 227</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               incommensurate or not.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 228</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `helical` Logical value, whether the magnetic structure is a helix</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 229</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               i.e. whether 2*k is non-integer.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 230</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `norm`    Logical value, is always false.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 231</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `nformula`Number of formula units in the unit cell that have been</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 232</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               used to scale Sab, as given in spinw.unit.nformula.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 233</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `param`   Struct containing input parameters, each corresponds to the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 234</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               input parameter of the same name:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 235</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               * `notwin`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 236</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               * `sortMode`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 237</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               * `tol`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 238</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               * `omega_tol`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 239</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               * `hermit`</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 240</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `title`   Character array, the title for the output spinwave, default</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 241</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               is 'Numerical LSWT spectrum'</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 242</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `gtensor` Logical value, whether a g-tensor has been included in the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 243</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%               calculation.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 244</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `obj`     The copy (clone) of the input `obj`, see [spinw.copy].</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 245</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `datestart`Character array, start date and time of the calculation</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 246</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%   * `dateend` Character array, end date and time of the calculation</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 247</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 248</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% The number of magnetic modes (labeled by `nMode`) for commensurate</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 249</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% structures is double the number of magnetic atoms in the magnetic cell.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 250</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% For incommensurate structures this number is tripled due to the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 251</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% appearance of the $(Q\pm k_m)$ Fourier components in the correlation</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 252</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% functions. For every $Q$ points in the following order:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 253</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% $(Q-k_m,Q,Q+k_m)$.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 254</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 255</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% If several twins exist in the sample, `omega` and `Sab` are packaged into</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 256</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% a cell, that contains $n_{twin}$ number of matrices.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 257</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 258</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% ### See Also</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 259</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 260</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% [spinw] \| [spinw.spinwavesym] \| [sw_mex] \| [spinw.powspec] \| [sortmode]</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 261</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre> (Calls: 1, Time: 230.906 s, 18014398508915912.00 Kb, 18014398508895372.00 Kb, 18014398509284328.00 Kb)</span><br/></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 262</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.987 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    484k/106k/12.6k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 263</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">pref = swpref; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    484k/106k/12.6k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 264</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    484k/106k/12.6k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 265</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% for linear scans create the Q line(s)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       816b/0b/816b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 266</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if nargin &gt; 1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.188 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 267</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hkl = <a href="file36.html">sw_qscan</a>(hkl); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 268</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 269</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    hkl = [];</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 270</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 271</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 272</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% save warning of eigorth</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 273</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">orthWarn0 = false; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 274</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    56.3k/80b/10.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 275</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% save warning for singular matrix</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       896b/0b/896b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 276</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">singWarn0 = warning('off','MATLAB:nearlySingularMatrix'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       896b/0b/896b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 277</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       896b/0b/896b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 278</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% use mex file by default?</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.049 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    16k/3.89k/6.17k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 279</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">useMex = pref.usemex; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    16k/3.89k/6.17k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 280</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    16k/3.89k/6.17k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 281</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% calculate symbolic spectrum if obj is in symbolic mode</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.015 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 282</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if obj.symbolic </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 283</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if numel(hkl) == 3</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 284</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        hkl = sym(hkl);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 285</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 286</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 287</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if ~isa(hkl,'sym')</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 288</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        inpForm.fname  = {'fitmode'};</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 289</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        inpForm.defval = {false    };</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 290</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        inpForm.size   = {[1 1]    };</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 291</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        param0 = sw_readparam(inpForm, varargin{:});</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 292</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 293</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        if ~param0.fitmode</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 294</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            warning('spinw:spinwave:MissingInput','No hkl value was given, spin wave spectrum for general Q (h,k,l) will be calculated!');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 295</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 296</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        spectra = obj.spinwavesym(varargin{:});</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 297</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 298</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        spectra = obj.spinwavesym(varargin{:},'hkl',hkl);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 299</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 300</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    return</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 301</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 302</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 303</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% help when executed without argument</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 304</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if nargin==1 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 305</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    swhelp spinw.spinwave</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 306</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    spectra = [];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 307</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    return</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 308</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 309</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 310</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">title0 = 'Numerical LSWT spectrum'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     27.3k/0b/14.2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 311</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       656b/0b/656b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 312</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.fname  = {'fitmode' 'notwin' 'sortMode' 'optmem' 'tol' 'hermit'}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       544b/0b/544b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 313</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.defval = {false     false    true       0        1e-4  true    }; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       544b/0b/544b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 314</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.size   = {[1 1]     [1 1]    [1 1]      [1 1]    [1 1] [1 1]   }; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       544b/0b/544b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 315</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.72k/0b/1.72k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 316</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.fname  = [inpForm.fname  {'omega_tol' 'saveSabp' 'saveV' 'saveH'}]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 317</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.defval = [inpForm.defval {1e-5        false      false   false  }]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 318</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.size   = [inpForm.size   {[1 1]       [1 1]      [1 1]   [1 1]  }]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 319</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 320</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.fname  = [inpForm.fname  {'formfact' 'formfactfun' 'title' 'gtensor'}]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.89k/0b/2.89k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 321</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.defval = [inpForm.defval {false       @sw_mff      title0  false    }]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 322</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.size   = [inpForm.size   {[1 -1]      [1 1]        [1 -2]  [1 1]    }]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 323</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 324</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.fname  = [inpForm.fname  {'cmplxBase' 'tid' 'fid' }]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.59k/0b/1.59k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 325</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.defval = [inpForm.defval {false       -1    -1    }]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.88k/0b/1.88k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 326</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">inpForm.size   = [inpForm.size   {[1 1]       [1 1] [1 1] }]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.88k/0b/1.88k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 327</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.502 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">   110k/33.1k/32.7k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 328</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">param = <a href="file44.html">sw_readparam</a>(inpForm, varargin{:}); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   110k/33.1k/32.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 329</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       960b/0b/960b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 330</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~param.fitmode </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       960b/0b/960b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 331</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % save the time of the beginning of the calculation</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.548 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">   224k/3.72k/30.4k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 332</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    spectra.datestart = <a href="file47.html">datestr</a>(<a href="file45.html">now</a>); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">   224k/3.72k/30.4k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 333</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   224k/3.72k/30.4k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 334</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 335</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.fitmode </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 336</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    param.sortMode = false;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 337</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    param.tid = 0;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 338</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 339</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.08k/0b/1.08k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 340</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.tid == -1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.044 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">  5.48k/1.94k/1.42k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 341</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    param.tid = pref.tid; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">  5.48k/1.94k/1.42k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 342</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">  5.48k/1.94k/1.42k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 343</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       976b/0b/976b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 344</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.fid == -1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.044 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">  2.89k/1.08k/1.39k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 345</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    param.fid = pref.fid; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">  2.89k/1.08k/1.39k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 346</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       768b/0b/768b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 347</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">fid = param.fid; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       768b/0b/768b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 348</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       768b/0b/768b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 349</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% generate magnetic structure in the rotating noation</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.440 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">   209k/3.64k/17.1k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 350</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">magStr = obj.magstr; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   209k/3.64k/17.1k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 351</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   209k/3.64k/17.1k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 352</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% size of the extended magnetic unit cell</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 353</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nExt    = magStr.N_ext; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 354</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% magnetic ordering wavevector in the extended magnetic unit cell</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.45k/0b/1.45k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 355</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">km = magStr.k.*nExt; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.45k/0b/1.45k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 356</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.45k/0b/1.45k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 357</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% whether the structure is incommensurate</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.25k/0b/1.25k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 358</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">incomm = any(abs(km-round(km)) &gt; param.tol); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.25k/0b/1.25k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 359</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 360</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~incomm &amp;&amp; param.saveSabp </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 361</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    warning('spinw:spinwave:CommensurateSabp', ['The dynamical structure '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 362</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            'factor in the rotating frame has been requested, but the ', ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 363</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            'structure is commensurate so this will have no effect.']);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 364</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 365</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 366</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Transform the momentum values to the new lattice coordinate system</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       352b/0b/352b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 367</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hkl = obj.unit.qmat*hkl; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       352b/0b/352b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 368</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       352b/0b/352b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 369</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Calculates momentum transfer in A^-1 units.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.057 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       30.7k/80b/9k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 370</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hklA = 2*pi*(hkl'/obj.basisvector)'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       30.7k/80b/9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 371</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       30.7k/80b/9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 372</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Check for 2*km</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 373</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">tol = param.tol*2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 374</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">helical =  sum(abs(mod(abs(2*km)+tol,1)-tol).^2) &gt; tol; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 375</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 376</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% number of Q points</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 377</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nHkl0 = size(hkl,2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 378</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       2.5k/0b/2.5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 379</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% define Q scans for the twins</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.38k/0b/1.38k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 380</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nTwin = size(obj.twin.vol,2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       624b/0b/624b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 381</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.notwin </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       624b/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 382</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nTwin = 1;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       624b/0b/624b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 383</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       624b/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 384</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       624b/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 385</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% if the single twin has no rotation set param.notwin true</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.58k/0b/3.58k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 386</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">rotc1 = obj.twin.rotc(:,:,1)-eye(3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.17k/0b/1.17k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 387</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if (nTwin == 1) &amp;&amp; norm(rotc1(:))==0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 388</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    param.notwin = true; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 389</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 390</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 391</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~param.notwin </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 392</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % In the abc coordinate system of the selected twin the scan is</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 393</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % rotated opposite direction to rotC.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 394</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    hkl  = obj.twinq(hkl);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 395</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nHkl = nHkl0*nTwin;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 396</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 397</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    nHkl = nHkl0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 398</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hkl  = {hkl}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 399</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 400</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 401</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if incomm </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 402</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % TODO</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 403</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if ~helical &amp;&amp; ~param.fitmode</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 404</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        warning('spinw:spinwave:Twokm',['The two times the magnetic ordering '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 405</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            'wavevector 2*km = G, reciproc lattice vector, use magnetic supercell to calculate spectrum!']);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 406</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 407</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 408</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    hkl0 = cell(1,nTwin);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 409</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    hklExt = cell(1,nTwin);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 410</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 411</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    for tt = 1:nTwin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 412</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % without the k_m: (k, k, k)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 413</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        hkl0{tt} = repmat(hkl{tt},[1 3]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 414</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 415</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % for wavevectors in the extended unit cell km won't be multiplied by</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 416</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % nExt (we devide here to cancel the multiplication later)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 417</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        kme = km./nExt;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 418</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        hklExt{tt}  = [bsxfun(@minus,hkl{tt},kme') hkl{tt} bsxfun(@plus,hkl{tt},kme')];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 419</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 420</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % calculate dispersion for (k-km, k, k+km)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 421</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        hkl{tt}  = [bsxfun(@minus,hkl{tt},km') hkl{tt} bsxfun(@plus,hkl{tt},km')];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 422</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 423</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nHkl  = nHkl*3;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 424</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nHkl0 = nHkl0*3;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 425</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 426</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hkl0   = hkl; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 427</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hklExt = hkl; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 428</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 429</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.025 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     22.7k/0b/13.4k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 430</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hkl    = <a href="file62.html">cell2mat</a>(hkl); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.024 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.52k/0b/1.02k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 431</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hkl0   = <a href="file62.html">cell2mat</a>(hkl0); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.024 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/224b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 432</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hklExt = <a href="file62.html">cell2mat</a>(hklExt); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/224b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 433</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/224b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 434</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% determines a twin index for every q point</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.44k/0b/1.44k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 435</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">twinIdx = repmat(1:nTwin,[nHkl0 1]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.44k/0b/1.44k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 436</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">twinIdx = twinIdx(:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.44k/0b/1.44k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 437</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.44k/0b/1.44k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 438</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Create the interaction matrix and atomic positions in the extended</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.44k/0b/1.44k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 439</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% magnetic unit cell.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.238 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    4.26m/1.8m/1.5m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 440</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[SS, SI, RR] = obj.intmatrix('fitmode',true,'conjugate',true); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    4.26m/1.8m/1.5m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 441</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    4.26m/1.8m/1.5m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 442</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% add the dipolar interactions to SS.all</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">         0b/514k/0b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 443</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">SS.all = [SS.all SS.dip]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">         0b/514k/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 444</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">         0b/514k/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 445</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% is there any biquadratic exchange</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 446</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">bq = SS.all(15,:)==1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 447</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 448</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Biquadratic exchange only supported for commensurate structures</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 449</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if incomm &amp;&amp; any(bq) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 450</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    error('spinw:spinwave:Biquadratic','Biquadratic exchange can be only calculated for k=0 structures!');</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 451</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 452</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 453</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if any(bq) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 454</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Separate the biquadratic couplings</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 455</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Just use the SS.bq matrix produced by intmatrix(), it won't contain</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 456</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % the transpose matrices (not necessary for biquadratic exchange)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 457</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % TODO check whether to keep the transposed matrices to be sure</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 458</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    SS.bq = SS.all(1:6,bq);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 459</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Keep only the quadratic exchange couplings</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 460</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    SS.all = SS.all(1:14,SS.all(15,:)==0);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 461</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 462</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.19k/0b/2.19k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 463</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Converts wavevctor list into the extended unit cell</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.62k/0b/2.62k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 464</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hklExt  = bsxfun(@times,hklExt,nExt')*2*pi; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.62k/0b/2.62k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 465</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% q values without the +/-k_m value</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.03k/0b/2.03k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 466</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hklExt0 = bsxfun(@times,hkl0,nExt')*2*pi; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.03k/0b/2.03k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 467</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.03k/0b/2.03k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 468</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Calculates parameters eta and zed.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 469</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if isempty(magStr.S) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 470</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    error('spinw:spinwave:NoMagneticStr','No magnetic structure defined in obj!');</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 471</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 472</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       832b/0b/832b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 473</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">M0 = magStr.S; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.03k/0b/1.03k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 474</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">S0 = sqrt(sum(M0.^2,1)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.03k/0b/1.03k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 475</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% normal to rotation of the magnetic moments</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 476</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">n  = magStr.n; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 477</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nMagExt = size(M0,2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 478</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 479</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if incomm </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 480</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    fprintf0(fid,['Calculating INCOMMENSURATE spin wave spectra '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 481</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        '(nMagExt = %d, nHkl = %d, nTwin = %d)...\n'],nMagExt, nHkl0, nTwin);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 482</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.016 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/992b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 483</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    <a href="file66.html">fprintf0</a>(fid,['Calculating COMMENSURATE spin wave spectra '... </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">  7.61k/8.02k/3.03k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 484</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        '(nMagExt = %d, nHkl = %d, nTwin = %d)...\n'],nMagExt, nHkl0, nTwin); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 485</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 486</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 487</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% If cmplxBase is false, we use a local (e1,e2,e3) coordinate system fixed</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 488</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% to the moments:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 489</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% e3||Si,ata</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 490</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% e2 = Si x [1,0,0], if Si || [1,0,0] --&gt; e2 = [0,0,1]</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 491</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% e1 = e2 x e3</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 492</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% If cmplxBase is true, we use a coordinate system fixed by the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 493</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% complex magnetisation vectors:</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 494</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% e1 = imag(M)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 495</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% e3 = real(M)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.53k/0b/1.53k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 496</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% e2 = e3 x e1</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.94k/0b/1.94k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 497</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~param.cmplxBase </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.94k/0b/1.94k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 498</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % e3 || Si</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     19.9k/0b/19.9k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 499</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    e3 = bsxfun(@rdivide,M0,S0); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     19.9k/0b/19.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 500</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % e2 = Si x [1,0,0], if Si || [1,0,0] --&gt; e2 = [0,0,1]</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     35.5k/0b/35.5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 501</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    e2  = [zeros(1,nMagExt); e3(3,:); -e3(2,:)]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.31k/0b/2.31k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 502</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    e2(3,~any(abs(e2)&gt;1e-10)) = 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     5.62k/0b/5.62k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 503</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    e2  = bsxfun(@rdivide,e2,sqrt(sum(e2.^2,1))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     5.62k/0b/5.62k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 504</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % e1 = e2 x e3</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.055 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 505</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    e1  = <a href="file58.html">cross</a>(e2,e3); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 506</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 507</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    F0  = obj.mag_str.F;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 508</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    RF0 = sqrt(sum(real(F0).^2,1));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 509</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    IF0 = sqrt(sum(imag(F0).^2,1));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 510</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % e3 = real(M)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 511</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    e3  = real(F0)./repmat(RF0,[3 1]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 512</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % e1 = imag(M) perpendicular to e3</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 513</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    e1  = imag(F0)./repmat(IF0,[3 1]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 514</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    e1  = e1-bsxfun(@times,sum(e1.*e3,1),e3);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 515</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    e1  = e1./repmat(sqrt(sum(e1.^2,1)),[3 1]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 516</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % e2 = cross(e3,e1)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 517</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    e2  = cross(e3,e1);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 518</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 519</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% assign complex vectors that define the rotating coordinate system on</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    32.4k/64b/17.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 520</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% every magnetic atom</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     34.1k/0b/34.1k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 521</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">zed = e1 + 1i*e2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     34.1k/0b/34.1k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 522</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">eta = e3; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     34.1k/0b/34.1k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 523</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       514k/0b/514k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 524</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dR    = [SS.all(1:3,:) zeros(3,nMagExt)]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       129k/0b/129k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 525</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">atom1 = [SS.all(4,:)   1:nMagExt]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       129k/0b/129k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 526</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">atom2 = [SS.all(5,:)   1:nMagExt]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       129k/0b/129k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 527</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% magnetic couplings, 3x3xnJ</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 528</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">JJ = cat(3,reshape(SS.all(6:14,:),3,3,[]),SI.aniso); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 529</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 530</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if incomm </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 531</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % transform JJ due to the incommensurate wavevector</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 532</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    [~, K] = sw_rot(n,km*dR*2*pi);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 533</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % multiply JJ with K matrices for every interaction</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 534</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % and symmetrising JJ for the rotating basis</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 535</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    JJ = (mmat(JJ,K)+mmat(K,JJ))/2;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 536</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 537</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 538</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nCoupling = size(JJ,3); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           1m/0b/1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 539</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       1.9m/0b/1.9m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 540</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">zedL = repmat(permute(zed(:,atom1),[1 3 2]),[1 3 1]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       1.9m/0b/1.9m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 541</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">zedR = repmat(permute(zed(:,atom2),[3 1 2]),[3 1 1]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       1.9m/0b/1.9m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 542</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       971k/0b/971k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 543</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">etaL = repmat(permute(eta(:,atom1),[1 3 2]),[1 3 1]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       971k/0b/971k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 544</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">etaR = repmat(permute(eta(:,atom2),[3 1 2]),[3 1 1]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       971k/0b/971k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 545</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       110k/0b/110k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 546</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">SiSj = sqrt(S0(atom1).*S0(atom2)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       110k/0b/110k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 547</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       110k/0b/110k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 548</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Creates temporary values for calculating matrix elements.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.025 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">      112k/32b/111k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 549</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">AD  =  <a href="file65.html">shiftdim</a>(sum(sum(etaL.*JJ.*etaR,2),1),1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       109k/0b/109k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 550</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">A20 = -S0(atom2).*AD; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       109k/0b/109k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 551</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">D20 = -S0(atom1).*AD; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.027 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">      223k/32b/218k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 552</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">BC0 =  SiSj.*<a href="file65.html">shiftdim</a>(sum(sum(zedL.*JJ.*     zedR ,2),1),1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.025 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">      217k/32b/217k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 553</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">AD0 =  SiSj.*<a href="file65.html">shiftdim</a>(sum(sum(zedL.*JJ.*conj(zedR),2),1),1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      217k/32b/217k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 554</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      217k/32b/217k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 555</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Magnetic field is different for every twin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      217k/32b/217k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 556</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%MF  =  repmat(obj.unit.muB*SI.field*eta,[1 2]);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 557</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">MF = zeros(1,2*nMagExt,nTwin); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 558</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for ii = 1:nTwin </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 559</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % rotate the magnetic field to the relative direction of every twin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 560</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % backward rotation with the rotc matrix of the twin</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.72k/0b/3.72k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 561</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    twinB = SI.field*obj.twin.rotc(:,:,ii)*obj.unit.muB; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.067 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    135k/118k/52.1k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 562</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    MF(:,:,ii) = repmat(twinB*permute(<a href="file55.html">mmat</a>(SI.g,permute(eta,[1 3 2])),[1 3 2]),[1 2]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.08k/0b/3.08k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 563</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.08k/0b/3.08k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 564</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.08k/0b/3.08k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 565</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Creates the serial indices for every matrix element in ham matrix.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       220k/0b/220k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 566</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">idxA1 = [atom1'         atom2'         ]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       219k/0b/219k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 567</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">idxA2 = [atom1'         atom1'         ]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.003 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       219k/0b/219k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 568</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">idxB  = [atom1'         atom2'+nMagExt ]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       219k/0b/219k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 569</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% transpose of idxB</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       219k/0b/219k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 570</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%idxC  = [atom2'+nMagExt atom1'         ]; % SP1</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       216k/0b/216k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 571</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">idxD1 = idxA1+nMagExt; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       258k/0b/258k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 572</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">idxD2 = [atom2'+nMagExt atom2'+nMagExt ]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 573</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">idxMF = [(1:2*nMagExt)' (1:2*nMagExt)' ]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 574</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 575</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Calculate matrix elements for biquadratic exchange</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 576</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if any(bq) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 577</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqdR    = SS.bq(1:3,:);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 578</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqAtom1 = SS.bq(4,:);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 579</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqAtom2 = SS.bq(5,:);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 580</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqJJ    = SS.bq(6,:);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 581</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nbqCoupling = numel(bqJJ);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 582</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 583</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % matrix elements: M,N,P,Q</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 584</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqM = sum(eta(:,bqAtom1).*eta(:,bqAtom2),1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 585</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqN = sum(eta(:,bqAtom1).*zed(:,bqAtom2),1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 586</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqO = sum(zed(:,bqAtom1).*zed(:,bqAtom2),1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 587</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqP = sum(conj(zed(:,bqAtom1)).*zed(:,bqAtom2),1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 588</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqQ = sum(zed(:,bqAtom1).*eta(:,bqAtom2),1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 589</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 590</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Si = S0(bqAtom1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 591</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Sj = S0(bqAtom2);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 592</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % C_ij matrix elements</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 593</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqA0 = (Si.*Sj).^(3/2).*(bqM.*conj(bqP) + bqQ.*conj(bqN)).*bqJJ;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 594</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqB0 = (Si.*Sj).^(3/2).*(bqM.*bqO + bqQ.*bqN).*bqJJ;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 595</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqC  = Si.*Sj.^2.*(conj(bqQ).*bqQ - 2*bqM.^2).*bqJJ;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 596</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    bqD  = Si.*Sj.^2.*(bqQ).^2.*bqJJ;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 597</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 598</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Creates the serial indices for every matrix element in ham matrix.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 599</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Aij(k) matrix elements (b^+ b)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 600</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    idxbqA  = [bqAtom1' bqAtom2'];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 601</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % b b^+ elements</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 602</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    idxbqA2 = [bqAtom1' bqAtom2']+nMagExt;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 603</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 604</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Bij(k) matrix elements (b^+ b^+)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 605</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    idxbqB  = [bqAtom1' bqAtom2'+nMagExt];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 606</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % transpose of B (b b)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 607</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %idxbqB2 = [bqAtom2'+nMagExt bqAtom1']; % SP2</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 608</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 609</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    idxbqC  = [bqAtom1' bqAtom1'];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 610</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    idxbqC2 = [bqAtom1' bqAtom1']+nMagExt;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 611</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 612</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    idxbqD  = [bqAtom1' bqAtom1'+nMagExt];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 613</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %idxbqD2 = [bqAtom1'+nMagExt bqAtom1]; % SP2</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 614</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 615</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 616</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 617</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 618</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 619</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 620</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% MEMORY MANAGEMENT LOOP</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 621</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     33.7k/0b/33.7k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 622</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 623</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.optmem == 0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 624</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    freeMem = sw_freemem;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 625</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if freeMem &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 626</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        nSlice = ceil(nMagExt^2*nHkl*6912/freeMem*2);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 627</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 628</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        nSlice = 1;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 629</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        if ~param.fitmode</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 630</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            warning('spinw:spinwave:FreeMemSize','The size of the free memory is unkown, no memory optimisation!');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 631</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 632</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 633</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 634</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    nSlice = param.optmem; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 635</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 636</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 637</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if nHkl &lt; nSlice </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 638</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    fprintf0(fid,['Memory allocation is not optimal, nMagExt is'...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 639</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        ' too large compared to the free memory!\n']);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       880b/0b/880b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 640</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nSlice = nHkl;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 641</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">elseif nSlice &gt; 1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.015 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       720b/0b/720b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 642</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    <a href="file66.html">fprintf0</a>(fid,['To optimise memory allocation, Q is cut'... </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     5.47k/0b/1.89k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 643</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        ' into %d pieces!\n'],nSlice); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.09k/0b/1.09k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 644</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.09k/0b/1.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 645</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.09k/0b/1.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 646</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% message for magnetic form factor calculation</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       912b/0b/912b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 647</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">yesNo = {'No' 'The'}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.013 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     18.1k/0b/3.97k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 648</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;"><a href="file66.html">fprintf0</a>(fid,[yesNo{param.formfact+1} ' magnetic form factor is'... </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     18.1k/0b/3.97k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 649</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ' included in the calculated structure factor.\n']);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     18.1k/0b/3.97k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 650</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% message for g-tensor calculation</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.013 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     15.8k/0b/4.34k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 651</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;"><a href="file66.html">fprintf0</a>(fid,[yesNo{param.gtensor+1} ' g-tensor is included in the '... </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     15.8k/0b/4.34k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 652</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    'calculated structure factor.\n']);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     15.8k/0b/4.34k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 653</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 654</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.gtensor </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 655</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 656</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    gtensor = SI.g;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 657</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 658</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if incomm</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 659</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % keep the rotation invariant part of g-tensor</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 660</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        nx  = [0 -n(3) n(2);n(3) 0 -n(1);-n(2) n(1) 0];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 661</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        nxn = n'*n;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 662</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        m1  = eye(3);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 663</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        gtensor = 1/2*gtensor - 1/2*mmat(mmat(nx,gtensor),nx) + 1/2*mmat(mmat(nxn-m1,gtensor),nxn) + 1/2*mmat(mmat(nxn,gtensor),2*nxn-m1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.11k/0b/3.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 664</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.69k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 665</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.69k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 666</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.83k/0b/1.83k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 667</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">hklIdx = [floor(((1:nSlice)-1)/nSlice*nHkl)+1 nHkl+1]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.83k/0b/1.83k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 668</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.83k/0b/1.83k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 669</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Empty omega dispersion of all spin wave modes, size: 2*nMagExt x nHkl.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       670k/0b/670k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 670</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">omega = zeros(2*nMagExt, nHkl); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       670k/0b/670k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 671</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       670k/0b/670k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 672</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% empty Sab</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       576b/0b/576b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 673</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">Sab = zeros(3,3,2*nMagExt,0); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       576b/0b/576b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 674</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       576b/0b/576b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 675</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Empty matrices to save different intermediate results for further</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       576b/0b/576b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 676</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% analysis: Hamiltonian, eigenvectors, dynamical structure factor in the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       576b/0b/576b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 677</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% rotating frame</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 678</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.saveV </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 679</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Vsave = zeros(2*nMagExt,2*nMagExt,nHkl);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 680</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 681</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.saveH </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 682</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Hsave = zeros(2*nMagExt,2*nMagExt,nHkl);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 683</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 684</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.621 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     753k/164k/160k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 685</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;"><a href="file34.html">sw_timeit</a>(0,1,param.tid,'Spin wave spectrum calculation'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     753k/164k/160k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 686</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 687</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">warn1 = false; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 688</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.12k/0b/1.12k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 689</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% calculate all magnetic form factors</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 690</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.formfact </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 691</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    spectra.formfact = true;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 692</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Angstrom^-1 units for Q</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 693</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    hklA0 = 2*pi*(hkl0'/obj.basisvector)';</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 694</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % store form factor per Q point for each atom in the magnetic supercell</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 695</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % TODO check prod(nExt)? instead of nExt</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 696</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %FF = repmat(param.formfactfun(permute(obj.unit_cell.ff(1,:,obj.matom.idx),[3 2 1]),hklA0),[1 nExt]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.11k/0b/2.11k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 697</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    FF = repmat(param.formfactfun(permute(obj.unit_cell.ff(1,:,obj.matom.idx),[3 2 1]),hklA0),[prod(nExt) 1]);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 698</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.38k/0b/1.38k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 699</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    spectra.formfact = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.64k/0b/1.64k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 700</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.64k/0b/1.64k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 701</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.78k/0b/2.78k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 702</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for jj = 1:nSlice </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.78k/0b/2.78k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 703</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % q indices selected for every chunk</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       14k/0b/2.41k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 704</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hklIdxMEM  = hklIdx(jj):(hklIdx(jj+1)-1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       14k/0b/2.41k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 705</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % q values contatining the k_m vector</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     11.7k/0b/2.98k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 706</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hklExtMEM  = hklExt(:,hklIdxMEM); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     11.7k/0b/2.98k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 707</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % q values without the +/-k_m vector</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">    9.44k/32b/2.14k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 708</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    hklExt0MEM = hklExt0(:,hklIdxMEM); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    9.44k/32b/2.14k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 709</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % twin indices for every q point</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     6.59k/0b/2.27k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 710</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    twinIdxMEM = twinIdx(hklIdxMEM); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">          0b/64b/0b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 711</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    nHklMEM = size(hklExtMEM,2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">          0b/64b/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 712</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">          0b/64b/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 713</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Creates the matrix of exponential factors nCoupling x nHkl size.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">          0b/64b/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 714</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Extends dR into 3 x 3 x nCoupling x nHkl</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">          0b/64b/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 715</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %     ExpF = exp(1i*permute(sum(repmat(dR,[1 1 nHklMEM]).*repmat(...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">          0b/64b/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 716</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %         permute(hklExtMEM,[1 3 2]),[1 nCoupling 1]),1),[2 3 1]))';</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.036 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     11.8m/0b/1.21m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 717</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ExpF = exp(1i*permute(sum(bsxfun(@times,dR,permute(hklExtMEM,[1 3 2])),1),[2 3 1]))'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     11.8m/0b/1.21m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 718</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     11.8m/0b/1.21m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 719</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Creates the matrix elements containing zed.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.023 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 720</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    A1 = bsxfun(@times,     AD0 ,ExpF); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.023 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     1.26m/0b/1.05m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 721</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    B  = bsxfun(@times,     BC0 ,ExpF); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.024 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 722</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    D1 = bsxfun(@times,conj(AD0),ExpF); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 723</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 724</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 725</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 726</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Store all indices</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 727</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % SP1: speedup for creating the matrix elements</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.27m/0b/1.05m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 728</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %idxAll = [idxA1; idxB; idxC; idxD1]; % SP1</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.020 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">    647k/44.5m/647k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 729</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    idxAll   = [idxA1; idxB; idxD1]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    647k/44.5m/647k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 730</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Store all matrix elements</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    647k/44.5m/647k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 731</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %ABCD   = [A1     B     conj(B)  D1]; % SP1</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.036 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     3.79m/0b/3.16m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 732</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ABCD   = [A1     2*B      D1]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.79m/0b/3.16m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 733</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.79m/0b/3.16m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 734</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Stores the matrix elements in ham.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.79m/0b/3.16m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 735</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %idx3   = repmat(1:nHklMEM,[4*nCoupling 1]); % SP1</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.023 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.9m/0b/1.58m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 736</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    idx3   = repmat(1:nHklMEM,[3*nCoupling 1]); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.070 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     73.7m/0b/7.37m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 737</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    idxAll = [repmat(idxAll,[nHklMEM 1]) idx3(:)]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.041 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">        0b/24.1m/0b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 738</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    idxAll = idxAll(:,[2 1 3]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">        0b/24.1m/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 739</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.029 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">        0b/24.1m/0b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 740</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ABCD   = ABCD'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">        0b/24.1m/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 741</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">        0b/24.1m/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 742</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">        0b/24.1m/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 743</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % quadratic form of the boson Hamiltonian stored as a square matrix</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.621 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/129m/1.68e+07t </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 744</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ham = accumarray(idxAll,ABCD(:),[2*nMagExt 2*nMagExt nHklMEM]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/129m/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 745</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.832 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 746</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ham = ham + repmat(accumarray([idxA2; idxD2],2*[A20 D20],[1 1]*2*nMagExt),[1 1 nHklMEM]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 747</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.078 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 748</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if any(bq) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 749</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % bqExpF = exp(1i*permute(sum(repmat(bqdR,[1 1 nHklMEM]).*repmat(...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 750</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %     permute(hklExtMEM,[1 3 2]),[1 nbqCoupling 1]),1),[2 3 1]))';</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 751</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqExpF = exp(1i*permute(sum(bsxfun(@times,bqdR,permute(hklExtMEM,[1 3 2])),1),[2 3 1]))';</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 752</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 753</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqA  = bsxfun(@times,     bqA0, bqExpF);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 754</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqA2 = bsxfun(@times,conj(bqA0),bqExpF);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 755</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqB  = bsxfun(@times,     bqB0, bqExpF);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 756</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        idxbqAll = [idxbqA; idxbqA2; idxbqB];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 757</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %bqABCD = [bqA bqA2 2*bqB];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 758</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqABCD = [bqA bqA2 2*bqB];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 759</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqidx3   = repmat(1:nHklMEM,[3*nbqCoupling 1]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 760</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        idxbqAll = [repmat(idxbqAll,[nHklMEM 1]) bqidx3(:)];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 761</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        idxbqAll = idxbqAll(:,[2 1 3]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 762</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        bqABCD = bqABCD';</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 763</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % add biquadratic exchange</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 764</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        ham = ham + accumarray(idxbqAll,bqABCD(:),[2*nMagExt 2*nMagExt nHklMEM]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 765</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % add diagonal terms</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 766</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        ham = ham + repmat(accumarray([idxbqC; idxbqC2; idxbqD],[bqC bqC 2*bqD],[1 1]*2*nMagExt),[1 1 nHklMEM]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 767</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.033 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     2.69k/0b/1.55k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 768</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.019 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 769</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if any(SI.field) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 770</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % different field for different twin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 771</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        for ii = min(twinIdxMEM):max(twinIdxMEM)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 772</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            nTwinQ = sum(twinIdxMEM==ii);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 773</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            ham(:,:,twinIdxMEM==ii) = ham(:,:,twinIdxMEM==ii) + ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 774</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                repmat(accumarray(idxMF,MF(:,:,ii),[1 1]*2*nMagExt),[1 1 nTwinQ]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 775</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 776</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 777</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %ham = ham + repmat(accumarray(idxMF,MF,[1 1]*2*nMagExt),[1 1 nHklMEM]);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 778</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.05k/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 779</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.505 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      2.5k/0b/1.28k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 780</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ham = (ham + conj(permute(ham,[2 1 3])))/2; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      2.5k/0b/1.28k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 781</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      2.5k/0b/1.28k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 782</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % diagonal of the boson commutator matrix</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.080 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     18.7k/0b/17.4k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 783</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    gCommd = [ones(nMagExt,1); -ones(nMagExt,1)]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     18.7k/0b/17.4k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 784</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % boson commutator matrix</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.063 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     16.1m/0b/16.1m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 785</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    gComm  = diag(gCommd); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     16.1m/0b/16.1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 786</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %gd = diag(g);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     16.1m/0b/16.1m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 787</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.021 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 788</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if param.hermit </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 789</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % All the matrix calculations are according to Colpa's paper</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 790</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % J.H.P. Colpa, Physica 93A (1978) 327-353</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 791</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 792</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % basis functions of the magnon modes</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 793</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        V = zeros(2*nMagExt,2*nMagExt,nHklMEM);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 794</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 795</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        if useMex &amp;&amp; nHklMEM&gt;1</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 796</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % use mex files to speed up the calculation</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 797</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % mex file will return an error if the matrix is not positive definite.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 798</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            [K2, invK] = chol_omp(ham,'Colpa','tol',param.omega_tol);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 799</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            [V, omega(:,hklIdxMEM)] = eig_omp(K2,'sort','descend');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 800</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % the inverse of the para-unitary transformation V</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 801</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            for ii = 1:nHklMEM</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 802</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                V(:,:,ii) = V(:,:,ii)*diag(sqrt(gCommd.*omega(:,hklIdxMEM(ii))));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 803</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 804</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % V = bsxfun(@times,invK,V);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 805</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            V = sw_mtimesx(invK,V);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 806</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 807</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            for ii = 1:nHklMEM</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 808</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                [K, posDef]  = chol(ham(:,:,ii));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 809</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                if posDef &gt; 0</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 810</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    try</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 811</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                        % get tolerance from smallest negative eigenvalue</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 812</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        tol0 = eig(ham(:,:,ii));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 813</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        tol0 = sort(real(tol0));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 814</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        tol0 = abs(tol0(1));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 815</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                        % TODO determine the right tolerance value</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 816</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        tol0 = tol0*sqrt(nMagExt*2)*4;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 817</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        if tol0&gt;param.omega_tol</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 818</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            error('spinw:spinwave:NonPosDefHamiltonian','Very baaaad!');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 819</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 820</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        try</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 821</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            K = chol(ham(:,:,ii)+eye(2*nMagExt)*tol0);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 822</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        catch</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 823</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            K = chol(ham(:,:,ii)+eye(2*nMagExt)*param.omega_tol);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 824</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 825</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        warn1 = true;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 826</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    catch PD</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 827</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        if param.tid == 2</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 828</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                            % close timer window</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 829</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            sw_timeit(100,2,param.tid);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 830</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 831</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                        error('spinw:spinwave:NonPosDefHamiltonian',...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 832</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            ['Hamiltonian matrix is not positive definite, probably'...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 833</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            ' the magnetic structure is wrong! For approximate'...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 834</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                            ' diagonalization try the param.hermit=false option']);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 835</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 836</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 837</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 838</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                K2 = K*gComm*K';</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 839</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                K2 = 1/2*(K2+K2');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 840</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % Hermitian K2 will give orthogonal eigenvectors</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 841</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                [U, D] = eig(K2);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 842</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                D      = diag(D);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 843</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 844</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % sort modes accordign to the real part of the energy</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 845</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                [~, idx] = sort(real(D),'descend');</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 846</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                U = U(:,idx);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 847</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % omega dispersion</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 848</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                omega(:, hklIdxMEM(ii)) = D(idx);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 849</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 850</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                % the inverse of the para-unitary transformation V</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 851</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">                V(:,:,ii) = inv(K)*U*diag(sqrt(gCommd.*omega(:, hklIdxMEM(ii)))); %#ok&lt;MINV&gt;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 852</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 853</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.018 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 854</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    else </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 855</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % All the matrix calculations are according to White's paper</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.16k/0b/624b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 856</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % R.M. White, et al., Physical Review 139, A450?A454 (1965)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.018 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.56k/0b/880b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 857</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        if useMex </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.618 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">1.04g/1.68e+07t/579m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 858</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            gham = <a href="file70.html">sw_mtimesx</a>(gComm, ham); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.04g/1.68e+07t/579m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 859</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.04g/1.68e+07t/579m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 860</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            gham = mmat(gComm,ham);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.051 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">1.04g/1.68e+07t/579m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 861</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.04g/1.68e+07t/579m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 862</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 130.016 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">   3.71g/1.67g/386m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 863</span><a name="Line863"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">        [V, D, orthWarn] = <a href="file71.html">eigorth</a>(gham,param.omega_tol,useMex); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   3.71g/1.67g/386m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 864</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.018 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">   3.71g/1.67g/386m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 865</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        orthWarn0 = orthWarn || orthWarn0; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   3.71g/1.67g/386m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 866</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.018 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.03k/0b/656b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 867</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for ii = 1:nHklMEM </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.03k/0b/656b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 868</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % multiplication with g removed to get negative and positive</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.03k/0b/656b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 869</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % energies as well</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.192 </span></pre></td><td><pre><span style="color: #0000FF">     59 </span></pre></td><td><pre><span style="color: #20AF20">       670k/0b/670k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 870</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            omega(:,hklIdxMEM(ii)) = D(:,ii); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 20.868 </span></pre></td><td><pre><span style="color: #0000FF">     59 </span></pre></td><td><pre><span style="color: #20AF20">     29.1k/0b/25.5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 871</span><a name="Line871"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">            M              = diag(gComm*V(:,:,ii)'*gComm*V(:,:,ii)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  9.391 </span></pre></td><td><pre><span style="color: #0000FF">     59 </span></pre></td><td><pre><span style="color: #20AF20">        0b/1.85g/0b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 872</span><a name="Line872"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            V(:,:,ii)      = V(:,:,ii)*diag(sqrt(1./M)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.461 </span></pre></td><td><pre><span style="color: #0000FF">     59 </span></pre></td><td><pre><span style="color: #20AF20">      1.36k/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 873</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.035 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.36k/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 874</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.36k/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 875</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.019 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 876</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if param.saveV </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 877</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        Vsave(:,:,hklIdxMEM) = V;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 878</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.018 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 879</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if param.saveH </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 880</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        Hsave(:,:,hklIdxMEM) = ham;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       992b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 881</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 882</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 883</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Calculates correlation functions.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       992b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 884</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % V right</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.274 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/0b/1.68e+07t </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 885</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    VExtR = repmat(permute(V  ,[4 5 1 2 3]),[3 3 1 1 1]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/0b/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 886</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % V left: conjugate transpose of V</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.795 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">290m/1.68e+07t/290m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 887</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    VExtL = conj(permute(VExtR,[1 2 4 3 5])); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">290m/1.68e+07t/290m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 888</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">290m/1.68e+07t/290m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 889</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Introduces the exp(-ikR) exponential factor.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.082 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">        0b/11.8m/0b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 890</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ExpF =  exp(-1i*sum(repmat(permute(hklExt0MEM,[1 3 2]),[1 nMagExt 1]).*repmat(RR,[1 1 nHklMEM]),1)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">        0b/11.8m/0b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 891</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Includes the sqrt(Si/2) prefactor.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.039 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     2.48k/0b/1.38k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 892</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ExpF = ExpF.*repmat(sqrt(S0/2),[1 1 nHklMEM]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.48k/0b/1.38k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 893</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.545 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      1.7g/0b/1.41g </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 894</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ExpFL =      repmat(permute(ExpF,[1 4 5 2 3]),[3 3 2*nMagExt 2]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      1.7g/0b/1.41g </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 895</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % conj transpose of ExpFL</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.014 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/0b/1.68e+07t </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 896</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ExpFR = conj(permute(ExpFL,[1 2 4 3 5])); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/0b/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 897</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.075 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">290m/1.68e+07t/290m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 898</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    zeda = repmat(permute([zed conj(zed)],[1 3 4 2]),[1 3 2*nMagExt 1 nHklMEM]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">290m/1.68e+07t/290m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 899</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % conj transpose of zeda</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.973 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/1.68e+07t/1.68e+07t </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 900</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    zedb = conj(permute(zeda,[2 1 4 3 5])); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/1.68e+07t/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 901</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/1.68e+07t/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 902</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % calculate magnetic structure factor using the hklExt0 Q-values</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/1.68e+07t/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 903</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % since the S(Q+/-k,omega) correlation functions also belong to the</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/1.68e+07t/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 904</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % F(Q)^2 form factor</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">1.68e+07t/1.68e+07t/1.68e+07t </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 905</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.086 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 906</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if param.formfact </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 907</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % include the form factor in the z^alpha, z^beta matrices</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 908</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        zeda = zeda.*repmat(permute(FF(:,hklIdxMEM),[3 4 5 1 2]),[3 3 2*nMagExt 2 1]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 909</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        zedb = zedb.*repmat(permute(FF(:,hklIdxMEM),[3 4 1 5 2]),[3 3 2 2*nMagExt 1]);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.034 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 910</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       976b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 911</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.019 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 912</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if param.gtensor </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 913</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % include the g-tensor</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 914</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        zeda = mmat(repmat(permute(gtensor,[1 2 4 3]),[1 1 1 2]),zeda);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 915</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        zedb = mmat(zedb,repmat(gtensor,[1 1 2]));</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.017 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 916</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 917</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Dynamical structure factor from S^alpha^beta(k) correlation function.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 918</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Sab(alpha,beta,iMode,iHkl), size: 3 x 3 x 2*nMagExt x nHkl.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.69k/0b/1.06k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 919</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Normalizes the intensity to single unit cell.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 10.672 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">  31.4m/15.4m/5.61m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 920</span><a name="Line920"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    Sab = cat(4,Sab,<a href="file73.html">squeeze</a>(sum(zeda.*ExpFL.*VExtL,4)).*<a href="file73.html">squeeze</a>(sum(zedb.*ExpFR.*VExtR,3))/prod(nExt)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">  31.4m/15.4m/5.61m </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 921</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 15.383 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">   2.03m/1.42m/226k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 922</span><a name="Line922"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">    <a href="file34.html">sw_timeit</a>(jj/nSlice*100,0,param.tid); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.018 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #20AF20">      14.9k/0b/2.5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 923</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">      14.9k/0b/2.5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 924</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     4.22k/0b/4.22k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 925</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[~,singWarn] = lastwarn; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     4.22k/0b/4.22k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 926</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% restore warning for singular matrix</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           5k/0b/5k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 927</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">warning(singWarn0.state,'MATLAB:nearlySingularMatrix'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           5k/0b/5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 928</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           5k/0b/5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 929</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% If number of formula units are given per cell normalize to formula</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           5k/0b/5k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 930</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% unit</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.48k/0b/1.48k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 931</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if obj.unit.nformula &gt; 0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.48k/0b/1.48k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 932</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Sab = Sab/double(obj.unit.nformula);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.48k/0b/1.48k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 933</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.48k/0b/1.48k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 934</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.466 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    182k/155k/32.8k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 935</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;"><a href="file34.html">sw_timeit</a>(100,2,param.tid); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">    182k/155k/32.8k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 936</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.011 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     14.8k/0b/3.22k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 937</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;"><a href="file66.html">fprintf0</a>(fid,'Calculation finished.\n'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     14.8k/0b/3.22k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 938</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           2k/0b/2k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 939</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if warn1 &amp;&amp; ~param.fitmode </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           2k/0b/2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 940</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    warning('spinw:spinwave:NonPosDefHamiltonian',['To make the Hamiltonian '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">           2k/0b/2k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 941</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        'positive definite, a small omega_tol value was added to its diagonal!'])</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.84k/0b/1.84k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 942</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.84k/0b/1.84k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 943</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.84k/0b/1.84k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 944</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.84k/0b/1.84k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 945</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% END MEMORY MANAGEMENT LOOP</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.84k/0b/1.84k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 946</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.84k/0b/1.84k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 947</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 948</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if incomm </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 949</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % resize matrices due to the incommensurability (k-km,k,k+km) multiplicity</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 950</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    kmIdx = repmat(sort(repmat([1 2 3],1,nHkl0/3)),1,nTwin);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 951</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Rodrigues' rotation formula.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 952</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nx  = [0 -n(3) n(2); n(3) 0 -n(1); -n(2) n(1) 0];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 953</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nxn = n'*n;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 954</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    K1 = 1/2*(eye(3) - nxn - 1i*nx);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 955</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    K2 = nxn;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 956</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 957</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % keep the rotation invariant part of Sab</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 958</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %nx  = [0 -n(3) n(2);n(3) 0 -n(1);-n(2) n(1) 0];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 959</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %nxn = n'*n;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 960</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    m1  = eye(3);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 961</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 962</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % if the 2*km vector is integer, the magnetic structure is not a true</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 963</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % helix</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 964</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %tol = param.tol*2;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 965</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %helical =  sum(abs(mod(abs(2*km)+tol,1)-tol).^2) &gt; tol;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 966</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 967</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if helical</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 968</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % integrating out the arbitrary initial phase of the helix</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 969</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        Sab = 1/2*Sab - 1/2*mmat(mmat(nx,Sab),nx) + 1/2*mmat(mmat(nxn-m1,Sab),nxn) + 1/2*mmat(mmat(nxn,Sab),2*nxn-m1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 970</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 971</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 972</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Save the structure factor in the rotating frame</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 973</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if param.saveSabp</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 974</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        Sabp = Sab(:,:,:,kmIdx==2);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 975</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        omegap = omega(:,kmIdx==2);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 976</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 977</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 978</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % dispersion</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 979</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    omega = [omega(:,kmIdx==1); omega(:,kmIdx==2); omega(:,kmIdx==3)];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 980</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % exchange matrices</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 981</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Sab   = cat(3,mmat(Sab(:,:,:,kmIdx==1),K1), mmat(Sab(:,:,:,kmIdx==2),K2), ...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 982</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        mmat(Sab(:,:,:,kmIdx==3),conj(K1)));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 983</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 984</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    hkl   = hkl(:,kmIdx==2);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 985</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    nHkl0 = nHkl0/3;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 986</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 987</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    helical = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 988</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.09k/0b/2.09k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 989</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 990</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~param.notwin </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 991</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if nTwin &gt; 1</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 992</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        omega = mat2cell(omega,size(omega,1),repmat(nHkl0,[1 nTwin]));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 993</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 994</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % Rotate the calculated correlation function into the twin coordinate</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 995</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % system using rotC</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 996</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    SabAll = cell(1,nTwin);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 997</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    for ii = 1:nTwin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 998</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % select the ii-th twin from the Q points</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 999</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        idx    = (1:nHkl0) + (ii-1)*nHkl0;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1000</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % select correlation function of twin ii</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1001</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        SabT   = Sab(:,:,:,idx);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1002</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        if param.sortMode</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1003</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % sort the spin wave modes</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1004</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            [omega{ii}, SabT] = sortmode(omega{ii},reshape(SabT,9,size(SabT,3),[]));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1005</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            SabT = reshape(SabT,3,3,size(SabT,2),[]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1006</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1007</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % size of the correlation function matrix</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1008</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        sSabT  = size(SabT);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1009</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % convert the matrix into cell of 3x3 matrices</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1010</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        SabT   = reshape(SabT,3,3,[]);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1011</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % select the rotation matrix of twin ii</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1012</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        rotC   = obj.twin.rotc(:,:,ii);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1013</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % rotate correlation function using arrayfun</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1014</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        SabRot = arrayfun(@(idx)(rotC*SabT(:,:,idx)*(rotC')),1:size(SabT,3),'UniformOutput',false);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1015</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        SabRot = cat(3,SabRot{:});</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1016</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % resize back the correlation matrix</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1017</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        SabAll{ii} = reshape(SabRot,sSabT);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1018</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1019</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    Sab = SabAll;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1020</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1021</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if nTwin == 1</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1022</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        Sab = Sab{1};</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1023</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       704b/0b/704b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1024</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1025</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    if param.sortMode </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1026</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % sort the spin wave modes</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1027</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        [omega, Sab] = sortmode(omega,reshape(Sab,9,size(Sab,3),[]));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1028</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        Sab          = reshape(Sab,3,3,size(Sab,2),[]);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1029</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1030</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1031</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1032</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Creates output structure with the calculated values.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       544b/0b/544b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1033</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.omega    = omega; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       688b/0b/688b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1034</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.Sab      = Sab; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.97k/0b/2.97k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1035</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.hkl      = obj.unit.qmat\hkl(:,1:nHkl0); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       592b/0b/592b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1036</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.hklA     = hklA; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       592b/0b/592b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1037</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.incomm   = incomm; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       592b/0b/592b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1038</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.helical  = helical; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       592b/0b/592b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1039</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.norm     = false; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.14k/0b/2.14k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1040</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.nformula = int32(obj.unit.nformula); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.14k/0b/2.14k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1041</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     2.14k/0b/2.14k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1042</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% Save different intermediate results.</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1043</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.saveV </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1044</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    if param.notwin</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1045</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        spectra.V = Vsave;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1046</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    else</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1047</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        spectra.V = mat2cell(Vsave, size(Vsave, 1), size(Vsave, 1), repmat(nHkl0, [1 nTwin]));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1048</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    end</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       480b/0b/480b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1049</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1050</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.saveH </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1051</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    spectra.H = Hsave;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1052</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1053</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if param.saveSabp &amp;&amp; incomm </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1054</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    spectra.Sabp = Sabp;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1055</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    spectra.omegap = omegap;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1056</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1057</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">       528b/0b/528b </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1058</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% save the important parameters</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     2.55k/0b/2.55k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1059</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.param.notwin    = param.notwin; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.91k/0b/1.91k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1060</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.param.sortMode  = param.sortMode; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.91k/0b/1.91k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1061</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.param.tol       = param.tol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.91k/0b/1.91k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1062</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.param.omega_tol = param.omega_tol; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.91k/0b/1.91k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1063</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.param.hermit    = param.hermit; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.05k/0b/1.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1064</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.title           = param.title; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     1.05k/0b/1.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1065</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">spectra.gtensor         = param.gtensor; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     1.05k/0b/1.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1066</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.002 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">           1k/0b/1k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1067</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~param.fitmode </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.389 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">    12k/2.11k/1.33k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1068</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    spectra.dateend = <a href="file47.html">datestr</a>(<a href="file45.html">now</a>); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.835 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">   610k/93.8k/33.9k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1069</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    spectra.obj = copy(obj); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">   610k/93.8k/33.9k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1070</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">   610k/93.8k/33.9k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1071</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.004 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1072</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if ~param.gtensor &amp;&amp; any(obj.single_ion.g) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1073</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    warning('spinw:spinwave:NonZerogTensor',['The SpinW model defines a '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1074</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        'g-tensor that is not included in the calculation. Anisotropic '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1075</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        'g-tensor values cannot be applied afterwards as they change relative'...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1076</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">        'spin wave intensities!'])</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1077</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1078</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1079</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% issue eigorth warning</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1080</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if orthWarn0 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1081</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    warning('spinw:spinwave:NoOrth','Eigenvectors of defective eigenvalues cannot be orthogonalised at some q-point!');</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1082</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1083</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1084</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">if strcmp(singWarn,'MATLAB:nearlySingularMatrix') </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1085</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">    warning('spinw:spinwave:nearlySingularMatrix',['Matrix is close '...</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1086</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">            'to singular or badly scaled. Results may be inaccurate.']);</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.001 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1087</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #20AF20">     3.05k/0b/3.05k </span></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">1088</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.295 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #20AF20">       857m/0b/857m </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">1089</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>